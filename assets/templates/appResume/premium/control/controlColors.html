<control-colors class="control__colors">

    <div onClick={ changeColor } onUpdate="none" class="control__colors__item bg-{ $store.colors.getTitleById($State.get('color')) } control__colors__item--active"></div>
    <div class="control__colors__items">
        <div onClick={ onSelect } onUpdate="none" each={ item in $store.colors.get() } no-reorder class="control__colors__item bg-{ item.title }"></div>
    </div>

<script>

    this.onSelect = function(){
        this.onChange(this.item._id);
    };

    this.onChange = function(color){
        $State.select('color').set(color);
    };

    this.changeColor = function(){
        if (app.device.isMobile){
            var item = $store.colors
                .select({'_id': $State.get('color')})
                .right();

            if (!item) item = $store.colors.get(0);
            else item = item.get()

            this.onChange(item._id);
        }
    };

</script>

</control-colors>
