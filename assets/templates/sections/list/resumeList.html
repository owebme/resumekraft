<resume-list class="resume__list">

    <div onClick={ open.profile } onUpdate="none" class="main__button" data-icon="menu" data-color="white"></div>

    <div class="resume__list__title">Открыть меню</div>

    <resume-navbar></resume-navbar>

    <div name="sliderEl" class="resume__list__slider container slider" data-hidden="{ hidden }">
        <div class="slider__nav slider__nav__prev"></div>
        <div class="slider__nav slider__nav__next"></div>
        <div if={ $store.data.get().length } class="row slider__wrapper">
            <virtual each={ item, i in _.sortByDate($store.data.get(), "update", "desc") } no-reorder>
                <div class="slider__item col-md-12 col-lg-8">
                    <resume-list-item item={ item }></resume-list-item>
                </div>
                <div if={ i == 0 } class="slider__item col-md-12 col-lg-8">
                    <resume-list-item-new onClick={ open.createResume } onUpdate="none"></resume-list-item-new>
                </div>
            </virtual>
            <div if={ $store.data.get().length < 2 } class="slider__item col-md-12 col-lg-8">
                <resume-list-item-blank></resume-list-item-blank>
            </div>
        </div>
        <div if={ !$store.data.get().length } class="row slider__wrapper">
            <div class="slider__item col-md-12 col-lg-8">
                <resume-list-item-blank></resume-list-item>
            </div>
            <div class="slider__item col-md-12 col-lg-8">
                <resume-list-item-new onClick={ open.createResume } onUpdate="none"></resume-list-item-new>
            </div>
            <div class="slider__item col-md-12 col-lg-8">
                <resume-list-item-blank></resume-list-item-blank>
            </div>
        </div>
    </div>

<script>

    var $ = this,
    $scope = $$($.root);

    $.hidden = false;

    $.on("mount", function(){
        $.slider = new app.plugins.slider($.sliderEl);
    });

    $.start = function(callback){
        $afterlag.run(function(){
            $.slider.show(function(){
                if (_.isFunction(callback)){
                    callback();
                }
            });
        });
    };

    $.show = function(){
        $.update({
            hidden: false
        })
    };

    $.open = {
        createResume: function(){
            if (!app.metrika.get("offers.plan.show")){
                $Sections.offers.plan.show();
            }
            else {
                $Sections.resume.select.show(
                    app.metrika.get("resume.select.default")
                );
            }
            app.metrika.set("resume.buttonNew", true);
        },
        profile: function(){
            $.hide();
            $Sections.profile.section.show(function(){
                $.show();
            });
        },
        stat: function(){
            $.hide();
            $Sections.resume.stat.show(function(){
                $.show();
            });
        }
    };

    $.hide = function(){
        $.update({
            hidden: true
        })
    };

</script>

</resume-list>
