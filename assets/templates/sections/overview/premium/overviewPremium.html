<overview-premium class="oScreen zIndex-3 { showAnim-group1 : active }" data-open={ active } data-loader={ loading } data-show="down">

    <div class="oScreen__buttons" data-pos="top-right">
        <div onClick={ hide } class="button__close" data-color="gray"></div>
    </div>

    <div class="pos-br pr-l pb-l anim-group1 anim-scale zIndex-2" delay-show="l" delay-hide="none">
        <button onClick={ hide } class="btn btn-l btn-upper btn-default-hover-success">Подключить</button>
    </div>

    <div class="oScreen__content bg-white showAnim" name="scroll">

        <oScreen-loader></oScreen-loader>

        <div class="overview oScreen__content__fadeIn" name="content"></div>

    </div>

<script>

    var $ = this,
    $scope = $$($.root);

    $.active = false;

    $.loading = false;

    $.scroll = $$($["scroll"]);

    $.on("before-mount", function(){
        $.loader = $.tags["oscreen-loader"];
    });

    // $.on("mount", function(){
    //     $.show();
    // });

    $.show = function(){
        if ($.loading || $.active) return;

        $.loader.show(
            {
                scope: $.scroll,
                content: $.content,
                tag: function(){
                    return $.section = riot.mount($.content, "overview-premium-content", {
                        scope: $scope,
                        scroll: $.scroll,
                        content: $.content
                    })[0];
                },
                mount: function(tag){
                    tag.scrollFix = new app.plugins.scroll.fix({
                        scroll: $.scroll,
                        container: $.content
                    });

                    // tag.scroll.scrollTop($$(tag.root).find("#section").offset().top);

                    tag.scrollFix.init();

                    tag.chartRadial = new app.plugins.chartRadial(tag.chartRadialEl, {
                        container: "chart__radial__graph mb-m",
                        labels: "chart__radial__labels c-blackLight",
                        labelItem: "chart__radial__label mb-xxs"
                    });
                    tag.chartRadial.render([
                        {
                            title: "настольные ПК",
                            value: _.random(5, 87)
                        },
                        {
                            title: "планшеты",
                            value: _.random(5, 87)
                        },
                        {
                            title: "мобильные телефоны",
                            value: _.random(5, 87)
                        }
                    ]);
                },
                beforeUnmount: function(tag){
                    tag.chartRadial.destroy();
                    tag.scrollFix.destroy();
                }
            }
        );
    };

    $.hide = function(){
        $.update({
            active: false
        })
        _.onEndTransition($.scroll[0], function(){
            $.section.unmount(true);
        });
    };

</script>

</overview-premium>
