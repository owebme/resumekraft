<jobs-search-content-client class="section jobs__search__content">

    <div class="jobs__list">
        <div if={ !$store.jobs.items.length } class="jobs__list__empty text-center">
            <h3 class="c-silver mb-s">Нет подходящих результатов</h3>
            <p class="mb25">попробуйте смягчить условия поиска</p>
            <a onClick={ onBack } onUpdate="none" href="/jobs/search/" class="btn btn-l btn-primary-hover-success">Вернуться на шаг назад</a>
        </div>
        <div each={ item, i in $store.jobs.items } no-reorder class="jobs__list__item">
            <div class="jobs__list__item__content">
                <a target="_blank" href="/jobs/vacancy/{ item.id }/{ link(item.employer.name) }" class="jobs__list__item__title">{ item.name }</a>
                <div if={ item.salary } class="jobs__list__item__salary">
                    { 'от' : item.salary.from } { _.numberFormat(item.salary.from, 0, ".", " ") } <span if={ item.salary.to }>до { _.numberFormat(item.salary.to, 0, ".", " ") }</span> { currency(item.salary.currency) }
                </div>
                <div class="jobs__list__item__text">
                    <strong>Требования:</strong>
                    <jobs-search-content-raw content={ item.snippet.requirement }></jobs-search-content-raw>
                </div>
                <div class="jobs__list__item__company">
                    <div class="jobs__list__item__company__text" data-trusted={ item.employer.trusted }>{ item.employer.name }</div>
                </div>
                <div class="jobs__list__item__address">
                    <span class="jobs__list__item__address__city">{ item.area.name }</span><span if={ item.address && item.address.metro } class="jobs__list__item__address__metro"><span class="c-gray">&nbsp;&nbsp;•&nbsp;&nbsp;</span>{ item.address.metro.station_name }</span>&nbsp;&nbsp;•&nbsp;&nbsp;{ moment(item.published_at).format("D MMMM") }
                </div>
                <div class="jobs__list__item__buttons">
                    <icon-like color="blueBright" size="xs"></icon-like>
                    <div class="btn-default btn-m">Откликнуться</div>
                </div>
            </div>
        </div>
    </div>

<script>

    var $ = this;

    $.onBack = function(){
        History.back();
    };

    $.link = function(link){
        return link.replace(/\s+/gi, "-");
    }

    $.currency = function(code){
        if (code){
            return _.findWhere($store.jobs.dictionary.get("currency"), {"code": code}).abbr;
        }
    }

</script>

</jobs-search-content-client>

<jobs-search-content-raw>
    this.root.innerHTML = opts.content
</jobs-search-content-raw>
